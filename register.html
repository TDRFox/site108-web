<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SCP Fondation - Inscription</title>
<style>
  body { font-family: Arial, sans-serif; background:#121212; color:#eee; display:flex; justify-content:center; align-items:center; height:100vh; }
  form { background:#222; padding:20px; border-radius:8px; width:320px; }
  input, button { width:100%; padding:10px; margin:8px 0; border:none; border-radius:4px; }
  input { background:#333; color:#eee; }
  button { background:#5c6bc0; color:#fff; cursor:pointer; }
  button:hover { background:#3949ab; }
  a { color:#5c6bc0; text-decoration:none; }
  a:hover { text-decoration:underline; }
  #error {color:#ff5555;}
</style>
</head>
<body>

<form id="registerForm">
  <h2>Créer un compte SCP Fondation</h2>
  <input type="email" id="email" placeholder="Email" required />
  <input type="password" id="password" placeholder="Mot de passe (6+ caractères)" required minlength="6" />
  <input type="password" id="passwordConfirm" placeholder="Confirmer mot de passe" required minlength="6" />
  <button type="submit">S'inscrire</button>
  <p>Déjà un compte ? <a href="index.html">Se connecter</a></p>
  <p id="error"></p>
</form>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBFDgtfyPyNPkM2H8WklNfLqlj-bemVY1E",
  authDomain: "sitedusite108.firebaseapp.com",
  databaseURL: "https://sitedusite108-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "sitedusite108",
  storageBucket: "sitedusite108.firebasestorage.app",
  messagingSenderId: "927427226941",
  appId: "1:927427226941:web:63a9a600bd1c3bfc85a954"
};
firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.database();

const registerForm = document.getElementById('registerForm');
const errorP = document.getElementById('error');

registerForm.addEventListener('submit', e => {
  e.preventDefault();
  errorP.textContent = '';

  const email = registerForm.email.value.trim();
  const password = registerForm.password.value.trim();
  const passwordConfirm = registerForm.passwordConfirm.value.trim();

  if(password !== passwordConfirm){
    errorP.textContent = "Les mots de passe ne correspondent pas.";
    return;
  }

  auth.createUserWithEmailAndPassword(email, password)
    .then(({user}) => {
      // Créer profil utilisateur en DB avec accréditation par défaut 1
      const defaultAccreditation = "1";
      db.ref('users/' + user.uid).set({
        email: user.email,
        accreditation: defaultAccreditation,
        banned: false,
        staff: false
      }).then(() => {
        alert("Compte créé ! Vous pouvez maintenant vous connecter.");
        window.location.href = 'index.html';
      });
    })
    .catch(err => {
      errorP.textContent = err.message;
    });
});
</script>

</body>
</html>
